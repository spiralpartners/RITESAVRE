<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<!--
  UC: ログインする
  イベントリスト関連の処理を削除
 -->
<html>

<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<title>イベント一覧 | TEM</title>
	<link rel="stylesheet" type="text/css" href="css/default.css" />

	<script type='text/javascript' src='/RITESAVRE2/dwr/engine.js'></script>
	
	<script type="text/javascript" src="js/jquery-1.7.2.min.js"></script>
	<!-- <script type="text/javascript" src="js/tem-header.js"></script> -->
	<script type="text/javascript" src="/RITESAVRE2/dwr/interface/LoginController.js"></script>
	<script type="text/javascript" src="/RITESAVRE2/dwr/interface/LogoutController.js"></script>
	<script type="text/javascript" src="js/jquery.cookie.js"></script>
	<script type="text/javascript" src="js/jquery.serialize.js"></script>
	<script type='text/javascript'>
	
	//初期化処理追加
	//クッキーを参照して，登録されていればloggedInFormを表示する
	
var loggedInForm
	= '<form id="login_form">'
	+ '  <span>ようこそ <span class="uid"></span></span>'
	+ '  <input type="button" onclick="logout()" value="ログアウト" />'
	+ '</form>';


	// ログイン処理
	// dwrLogin():フォームからログインのケースと
	// dwrLogin(uid, pass):引数ログインのケースのオーバーロード
	function login() {
		var form;
		form = $('#login_form').serializeJson();
		
		LoginController.execute(form, {
			callback: function(data) {
				//クッキー登録
				$('#login_wrapper').html(loggedInForm);
				$('#menu_wrapper').text(data.role);
			},
			exceptionHandler: function(msg, err) {
				$('#header_error_msg').text(msg);
			}
		});
	}
	// ログアウト処理．クッキーを削除しヘッダを更新
	function logout(){
		LogoutController.execute({
			callback: function() {
				//クッキー削除
				location.reload();
			}
		});
	}

	</script>
</head>

<body>
	<div id="logo"></div>
	<div id="login_wrapper">
	<form id="login_form">
		 ユーザID <input type="text" name="userId"/>
		 パスワード <input type="password" name="pass" />
		<input type="button" onclick="login()" value="ログイン" />
		<span id="header_error_msg" class="error"></span>
	</form>
	</div>
	<hr>
	<div id="menu_wrapper" />
</body>


</html>